{% extends 'main/base.html' %}
{% load static %}

{% block references %}
<link type="text/css" href="{% static 'css/groups.css' %}" rel="stylesheet" />
{% endblock %}

{% block content %}
<div id="main" class="container">
	{% if messages %}
	<div class="row">
		{% for message in messages %}
		<div class="col-12"><div class="box message {% if message.tags %} {{ message.tags }}"{% endif %}>{{ message }}</div></div>
		{% endfor %}
	</div>
	{% endif %}

	<div class="row" style="height:100%">
		<div id="groups" class="col-12 col-sm-8">
			{% if user.is_authenticated %}
				{% if groups_in.count == 0 %}
					<div class="box message">
					It looks like you're not in any groups... for the best experience, try joining some of the recommended groups below or making your own!
					</div>
				{% else %}
					<div class="box box-title">
						<h1>Your Groups</h1>
					</div>
					{% for group in groups_in %}
					<div class="box">
						<div class="groupTitle">
							<a href="{% url 'group' group.pk %}">
								<img src="{{ group.photo.url }}">
								{{ group.name }}
							</a>
						</div>
					</div>
					{% endfor %}
				{% endif %}
			{% endif %}
			<div class="box box-title">
				<h1>Browse Groups</h1>
			</div>

			{% for group in groups %}
			<div class="box">
				<div class="groupTitle">
					<a href="{% url 'group' group.pk %}">
						<img src="{{ group.photo.url }}">
						{{ group.name }}
					</a>
				</div>
			</div>
			{% endfor %}
			<div class="box">
				<div class="groupTitle">
					<a href="group_page.html">
					<img src="{% static 'img/headshot.png' %}">
					MIT Confessions
					</a>
				</div>
				<hr>
				<div class="groupPosts d-flex flex-column justify-content-center">
					<a href="http://google.com" style="display: block;">
						<div>This is a test post that is going to be pretty long. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam
						</div>
					</a>
					<hr>
					<a href="http://google.com" style="display: block;">
						<div>This is a test post that is going to be pretty long. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam
						</div>
					</a>
					<hr>
					<a href="http://google.com" style="display: block;">
						<div>This is a test post that is going to be pretty long. Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam
						</div>
					</a>
				</div>
			</div>
		</div>
		<div id="sidebar" class="d-none d-sm-block col-sm-4">
			<div class="box">
					<h1> Suggested Groups </h1>
					
					<hr>
					{% if suggested_groups.count == 0 %}
					<div class="suggested-item">
						Groups that your friends are in will appear here.
					</div>
					{% endif %}
					{% for group in suggested_groups %}
						<div class="suggested-item">
							<table width="100%">
								<tr>
									<td width="5%">
										<img src="{{ group.photo.url }}">
									</td>
									<td width="90%">
										{{ group.name }}
									</td>
									<td>
										<form class="btn-group float-right" role="group" method="post" action="{% url 'join-group' group.pk %}" style="font-size: 5px; padding-right:0px;">
											<button class="btn btn-outline-notifications btn-sm" type="submit">Join</button>
										</form>
									</td>
								</tr>
							</table>
						</div>

					{% endfor %}
				</div>


			<div class="box">
				<h1> Quick Links </h1>
				<hr>
				<div class="suggested-item">
					<div class="groupLinks d-flex flex-column justify-content-center">
						<a href='#create-group' data-toggle="modal">
						Create a group
						</a>
						<!--
						<a href="www.youtube.com">
						Manage your groups
						</a>
						--!>
					</div>
				</div>
			</div>
		</div>
	</div>
</div>
<!-- Create Group Modal -->
<div class="modal fade" id="create-group" tabindex="-1" role="dialog" aria-labelledby="createGroupModal" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 >Create Group</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<form method='post'  enctype='multipart/form-data' action="{% url 'create-group' %}">{% csrf_token %}
				<div class="modal-body">
					{% if messages %}
					<div class="form-group row">
						{% for message in messages %}
						<div class="col-12 {% if message.tags %} {{ message.tags }}"{% endif %}>{{ message }}</div>
						{% endfor %}
					</div>
					{% endif %}
						<div class="form-group row">
							<label class="col-3 col-form-label" for="group-name">Group Name</label> 
							<div class="col-9">
								<input id="id-name" name="name" placeholder="My new awesome group!" type="text" class="form-control here" required="required">
							</div>
						</div>
						<div class="form-group row">
							<label for="moderated" class="col-3 col-form-label">Moderated</label> 
							<div class="col-9">
								<select id="id-moderated" name="moderated" required="required" class="form-control" aria-describedby="moderatedHelpBlock">
									<option value="True">Yes</option>
									<option value="False">No</option>
								</select>
								<span id="moderatedHelpBlock" class="form-text text-muted">Moderated groups require posts to be approved by administrators. An un-moderated group cannot be converted to a moderated group.</span>
							</div>
						</div>
						<div class="form-group row">
							<label class="col-3 col-form-label" for="photo">Photo</label> 
							<div class="col-9">
								<input id="photo" name="photo" type="file" class="form-control here" required="required">
							</div>
						</div>
				</div>
				<div class="modal-footer">
					<button name="submit" type="submit" class="btn btn-primary">Submit</button>
				</div>
			</form>
		</div>
	</div>
</div>
<!-- Settings Modal -->
<div class="modal fade" id="settings_overlay" tabindex="-1" role="dialog" aria-labelledby="settingsModal" aria-hidden="true">
	<div class="modal-dialog modal-dialog-centered" role="document">
		<div class="modal-content">
			<div class="modal-header">
				<h5 >Settings</h5>
				<button type="button" class="close" data-dismiss="modal" aria-label="Close">
				<span aria-hidden="true">&times;</span>
				</button>
			</div>
			<div class="modal-body">
				<form>
					<div class="form-group">
						<label for="exampleInputEmail1">Email address</label>
						<input type="email" class="form-control" id="exampleInputEmail1" aria-describedby="emailHelp" placeholder="Enter email">
						<small id="emailHelp" class="form-text text-muted">We'll never share your email with anyone else.</small>
					</div>
					<div class="form-group">
						<label for="exampleInputPassword1">Password</label>
						<input type="password" class="form-control" id="exampleInputPassword1" placeholder="Password">
					</div>
					<div class="form-check">
						<input type="checkbox" class="form-check-input" id="exampleCheck1">
						<label class="form-check-label" for="exampleCheck1">Check me out</label>
					</div>
					<button type="submit" class="btn btn-primary">Submit</button>
				</form>
			</div>
			<div class="modal-footer">
				<button type="button" class="btn btn-secondary" data-dismiss="modal">Close</button>
				<button type="button" class="btn btn-primary" onclick="saveSettings()" data-dismiss="modal">Save changes</button>
			</div>
		</div>
	</div>
</div>
{% endblock %}

{% block javascript %}
<script>
$(document).ready(function() {

  if(window.location.href.indexOf('#create-group') != -1) {
    $('#create-group').modal('show');
  }

});
</script>
{% endblock %}
